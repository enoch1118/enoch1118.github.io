---
layout: posts
title: CS-운영체제(1)-컴퓨터 시스템 구조
categories:
- cs
  
tags:
- cs
- 운영체제
---

### 컴퓨터 시스템 구조

CPU와 메모리가 있으면 컴퓨터라고 볼수있다.
메인 CPU의 작업공간은 Memory 이고
I/O 디바이스는 로컬버퍼를 가지고있어서 자신의 작업공간을 할당한다.
* CPU

> MODE BIT, REGISTERS, INTERRUPT LINE

CPU는 메모리에 있는 인스트럽션를 읽어 들어오기만 하는 일을 한다.

mode bit 은 현재 실행되고있는 프로그램이 운영체제인지. 아니면 사용자 프로그램인지 확인한다.

CPU 는 직접적으로 I/O디바이스에 접근을 하지않는데. 그럼 요청을 컨트롤러에게 보낸다.
그럼 컨트롤러는 CPU의 요청을 받아들인다음에 비는 시간에는 CPU에선 다음 인스트럽션을 실행시킨다.

빠르면서 쉬지않고 일하는것이 CPU 

* TIMER

CPU에 어떤 프로그램이 무한 루프에 들어갔을경우. CPU가 시분할로 동작할수가 없기때문에 메모리는
프로그램을 넘겨줄때 TIMER에 시간을 지정해서 같이 넘겨준다. 

그러면 세팅된 시간이 초과되었을땐 TIMER에서 CPU에 중단요청을 한다.
그럴때 쓰이는게 INTERRUPT LINE

결론적으로 CPU는 동작할땐

인스트럽션 -> 인터럽트라인 -> 인스트럽션 -> 인터럽트라인

순으로 동작. 인터럽트라인에 중단요청이 있을경우 해당 프로그램을 중단한다.
그럼 프로그램에서 CPU의 사용 권한을 OS에게 넘겨주고. 
OS는 다음 사용자 프로그램에게 CPU를 넘겨준다.

결론적으로 TIMER는 TIMESHARING SYSTEM 을 구현하기위해 필요한 장치

매클럭틱마다 1감소
0이되었을때 인터럽트 전달

* I/O 

사용자 프로그램은 I/O에 직접적인 요구를 할수없다.

그렇기때문에 사용자프로그램은 OS에 요청을 보내고 그다음에 OS에서 해당 I/O 컨트롤러로 요청
I/O 컨트롤러에서 해당 버퍼에 요청값을 보내고, 컨트롤러는 CPU에 인터럽트를 보낸다.

그제서야 사용자 프로그램이 CPU를 사용할수있게 되는것이다.

* MODE BIT

> 1:사용자모드
> <br>0:운영체제 모드/모니터모드/커널모드/시스템모드

위에 모드 비트를 통해 I/O에 접근을 관리한다.(보안상의 이유)
한정된 인스트럽션만 사용가능하게 한다.

* I/O DEVICE CONTROLLER

작은 CPU라고 생각하면된다.

* DMA컨트롤러(DIRECT MEMORY ACCESS)

너무 많은 인터럽트가 오게된다면 CPU가 효율적으로 동작할수없기 때문에 이런 상황을 막기위해
DMA가 메모리로 로컬버퍼를 복사하고 복사가 완료되서야 CPU에게 인터럽트를 건다.


* I/O 의 수행

SYSTEM CALL 사용자프로그램이 운영체제에게 요청
TRAP 을 사용하여 인터럽트 벡터의 특정 위치로 이동

* INTERRUPT

인터럽트 당한 시점의 레지스터와 PC를 SAVE CPU 의제어를 인터럽트 처리 루틴에 넘긴다.

INTERRUPT 를 말하면 대다수 하드웨어적 인터럽트를 말하고 
TRAP  는 소프트웨어의 인터럽트를 말한다.
> 오류 인터럽트
> <br>시스템콜:프로그램이 커널함수 호출

인터럽트 벡터
> 인터럽트의 처리 루틴 주소를 가지고있음
> <br>인터럽트 처리루틴/서비스 루틴/핸들러
> <br>인터럽트 처리 커널함수

현대의 운영체제는 인터럽트의 의해서 구동된다.